## 配置管理

[返回目录](./README.md)

### **功能介绍**  
配置信息的增删改查  

### **接口介绍**  
配置管理功能有4个接口  
创建配置接口  
删除配置接口  
修改配置接口  
查询配置列表接口  

## 创建配置接口

`英文名：`

createConfig

`解释：`

接收前端的数据存入本地存储。

`接口类型：`

```
POST
/api/v1/createConfig
Content-Type:application/json
```

`请求body` frontend逻辑

```json
{
  "name": "my config 1",
  "typ": "frontend",
  "conf": {
    "escProxyPort": 8888
  },
  "remark": "备注"
}
```

`请求body` backend逻辑

```json
{
  "name": "my config 1",
  "typ": "backend",
  "conf": {
    "serverPort": 12345
  },
  "remark": "备注"
}
```

`请求body` alert逻辑

```json
{
  "name": "my config 1",
  "typ": "alert",
  "conf": {
    "alertType": "mail",
    "alert": {
      //TODO 后面再写
    }
  },
  "remark": "备注"
}
```

`请求body` master逻辑

```json
{
  "name": "my config 1",
  "typ": "master",
  "conf": {
    "masterReservedMemory": 1
  },
  "remark": "备注"
}
```

`请求body` worker逻辑

```json
{
  "name": "my config 1",
  "typ": "worker",
  "conf": {
    "workerReservedMemory": 1
  },
  "remark": "备注"
}
```

`请求body` database逻辑

```json
{
  "name": "my config 1",
  "typ": "database",
  "conf": {
    "databaseType": "mysql",
    "dbName": "easy",
    "account": "easy",
    "password": "easy"
  },
  "remark": "备注"
}
```

`请求字段解释`

字段名|字段类型|是否必填|默认值|字段解释
--- | --- | --- | --- | ---
escProxyPort|int|true| |前端端口
serverPort|int|true| |后端端口
alertType|string|true| |告警类型，小写，取值范围【mail，weixin】
alert //TODO 后面在写 | | | |
masterReservedMemory|float|true| |master内存
workerReservedMemory|float|true| |worker内存
databaseType|string|true| |数据库类型，小写，取值范围【mysql，postgresql】
dbName|string|true| |数据库名，建议使用 dolphinscheduler
account|stirng|true| |数据库帐号
password|string|true| |数据库密码
remark|string|false| |备注

`响应body` 成功逻辑

```json
{
  "code": 200,
  "message": "ok",
  "result": null
}
```

`响应body` 失败逻辑

```json
{
  "code": 500,
  "message": "创建配置失败！{失败内容}",
  "result": null
}
```

`响应字段解释`

字段名|字段类型|是否必填|默认值|字段解释
--- | --- | --- | --- | ---
无| | | | 

## 删除配置接口

`英文名：`

deleteConfig

`解释：`

删除配置

`接口类型：`

```
POST
/api/v1/deleteConfig
Content-Type:application/json
```

`请求body`

```json
{
  "typ": "database",
  "id": 12123
}
```

`请求字段解释`

字段名|字段类型|是否必填|默认值|字段解释
--- | --- | --- | --- | ---
typ|string|true| |配置类型，小写，取值范围【frontend，backend，alert，master，worker，database】
id|int|true| |配置id

`响应body` 成功逻辑

```json
{
  "code": 200,
  "message": "ok",
  "result": null
}
```

`响应body` 失败逻辑

```json
{
  "code": 500,
  "message": "删除配置失败！{失败内容}",
  "result": null
}
```

`响应字段解释`

字段名|字段类型|是否必填|默认值|字段解释
--- | --- | --- | --- | ---
无||||

## 修改配置接口

`英文名：`

updateConfig

`解释：`

修改配置

`接口类型：`

```
POST
/api/v1/updateConfig
Content-Type:application/json
```

`请求body` frontend逻辑

```json
{
  "id": 1,
  "name": "my config 1",
  "typ": "frontend",
  "conf": {
    "escProxyPort": 8888
  },
  "remark": "备注"
}
```

`请求body` backend逻辑

```json
{
  "id": 1,
  "name": "my config 1",
  "typ": "backend",
  "conf": {
    "serverPort": 12345
  },
  "remark": "备注"
}
```

`请求body` alert逻辑

```json
{
  "id": 1,
  "name": "my config 1",
  "typ": "alert",
  "conf": {
    "alertType": "mail",
    "alert": {
      //TODO 后面再写
    }
  },
  "remark": "备注"
}
```

`请求body` master逻辑

```json
{
  "id": 1,
  "name": "my config 1",
  "typ": "master",
  "conf": {
    "masterReservedMemory": 1
  },
  "remark": "备注"
}
```

`请求body` worker逻辑

```json
{
  "id": 1,
  "name": "my config 1",
  "typ": "worker",
  "conf": {
    "workerReservedMemory": 1
  },
  "remark": "备注"
}
```

`请求body` database逻辑

```json
{
  "id": 1,
  "name": "my config 1",
  "typ": "database",
  "conf": {
    "databaseType": "mysql",
    "dbName": "easy",
    "account": "easy",
    "password": "easy"
  },
  "remark": "备注"
}
```

`请求字段解释`

字段名|字段类型|是否必填|默认值|字段解释
--- | --- | --- | --- | ---
id|int|true||配置id
escProxyPort|int|true| |前端端口
serverPort|int|true| |后端端口
alertType|string|true| |告警类型，小写，取值范围【mail，weixin】
alert //TODO 后面在写 | | | |
masterReservedMemory|float|true| |master内存
workerReservedMemory|float|true| |worker内存
databaseType|string|true| |数据库类型，小写，取值范围【mysql，postgresql】
dbName|string|true| |数据库名，建议使用 dolphinscheduler
account|stirng|true| |数据库帐号
password|string|true| |数据库密码
remark|string|false| |备注

`响应body` 成功逻辑

```json
{
  "code": 200,
  "message": "ok",
  "result": null
}
```

`响应body` 失败逻辑

```json
{
  "code": 500,
  "message": "修改配置错误！{错误信息}",
  "result": null
}
```

`响应字段解释`

字段名|字段类型|是否必填|默认值|字段解释
--- | --- | --- | --- | ---
无||||

## 查询配置列表接口

`英文名：`

selectConfigList

`解释：`

查询配置信息，分页返回。
（后端偷懒下）
每页会返回全部的数据。
每页会返回全部的数据。
每页会返回全部的数据。
每页会返回全部的数据。
由前端来控制显示列表，或，对应id的具体内容。
这里前端的压力可能稍微大一点，后期迭代成（先返回列表，用户点了列表里的id，再用id去获取具体的数据）。


`接口类型：`

```
GET
/api/v1/selectConfigList
```

`请求body`

```
http://0.0.0.0:15523/api/v1/selectConfigList?typ=master&page=1
```

`请求字段解释`

字段名|字段类型|是否必填|默认值|字段解释
--- | --- | --- | --- | ---
typ|string|true| |配置类型，小写，取值范围【frontend，backend，alert，master，worker，database】
page|int|true| |分页


`响应body` 成功逻辑

```json
{
  "code": 200,
  "message": "ok",
  "result": {
    "currentPage": 1,
    "total": 3,
    "data": [
      {
        "id": 123121,
        "name": "my config 1",
        "typ": "frontend",
        "conf": {
          "frontendPort": 8888
        },
        "remark": "备注"
      },
      {
        "id": 123122,
        "name": "my config 2",
        "typ": "frontend",
        "conf": {
          "frontendPort": 8882
        },
        "remark": "备注"
      },
      {
        "id": 123123,
        "name": "my config 3",
        "typ": "frontend",
        "conf": {
          "frontendPort": 8881
        },
        "remark": "备注"
      }
    ]
  }
}
```

`响应body` 失败逻辑

```json
{
  "code": 500,
  "message": "查询配置列表错误！{错误信息}",
  "result": null
}
```

`响应字段解释`

字段名|字段类型|是否必填|默认值|字段解释
--- | --- | --- | --- | ---
currentPage|int| | |当前页数
total|int| | |总配置数
data|string| | |日志内容


[返回目录](./README.md)